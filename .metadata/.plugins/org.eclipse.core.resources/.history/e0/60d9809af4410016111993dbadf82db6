package security;

import java.security.spec.AlgorithmParameterSpec;

import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

import sun.misc.BASE64Encoder;

public class EncrypterDecrypter {
	Cipher eCipher, dCipher;
	public static final String strPassword = "password12345678";
	public static SecretKeySpec keySpec = new SecretKeySpec(strPassword.getBytes(), "AES");

	public EncrypterDecrypter() {
		try {
			AlgorithmParameterSpec paramSpec = new IvParameterSpec(strPassword.getBytes());
			eCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
			dCipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
			eCipher.init(Cipher.ENCRYPT_MODE, keySpec, paramSpec);
			dCipher.init(Cipher.DECRYPT_MODE, keySpec, paramSpec);
		} catch (Exception e) {

		}
	}

	// encrypt inputs a string and return an encrypted version of that string
	public String encrypt(String string) {
		String encryptedString = null;
		try {
			// Encode the string into bytes using utf-8
			byte[] utf8 = string.getBytes("UTF-8");
			// Encrypt
			byte[] enc = eCipher.doFinal(utf8);
			// Encode bytes to base64 to get a string
			encryptedString = new BASE64Encoder().encode(enc);
		} catch (Exception e) {
		}
		return encryptedString;
	}
}
